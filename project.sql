CREATE TABLE TEMPERATURES(
    ID_TEMP INT AUTO_INCREMENT PRIMARY KEY,
    DATE_TEMP DATE,
    DEP_ID VARCHAR(3),
    DEPARTMENT VARCHAR(50),
    MIN_TEMP DECIMAL,
    MAX_TEMP DECIMAL,
    MEAN_TEMP DECIMAL
);

ALTER TABLE TEMPERATURES ADD COLUMN ID_TEMP INT AUTO_INCREMENT PRIMARY KEY;

CREATE VIEW DATES_TEMP_VIEW AS
SELECT ID_TEMP, DATE_TEMP, DEP_ID
FROM TEMPERATURES;


-- GET HOSPITALISATION TABLE
CREATE TABLE HOSPITALISATIONS(
    -- ID_HOP INT AUTO_INCREMENT PRIMARY KEY,
    DEP_ID VARCHAR(3),
    SEX INT,
    DATE_HOSP DATE,
    NUM_HOSP INT,
    NUM_INTENSE_CARE INT,
    NUM_CONV_HOSP INT,
    NUM_SSR_USLD INT,
    NUM_OTHERS INT,
    NUM_RETURN_HOME INT,
    NUM_DEATHS INT
);

ALTER TABLE HOSPITALISATIONS DROP COLUMN ID_HOP;
ALTER TABLE HOSPITALISATIONS ADD COLUMN ID_HOP INT AUTO_INCREMENT PRIMARY KEY;

SELECT DATE_HOSP, DEP_ID, NUM_HOSP
FROM HOSPITALISATIONS
WHERE DATE_HOSP LIKE "2019-%" OR DATE_HOSP LIKE "2020-%"
ORDER BY DATE_HOSP ASC